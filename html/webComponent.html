<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <template id="aTemplate">
        <style>
            h1{
                color: chocolate;
            }
        </style>
        <h1>hello world</h1>
    </template>
    <h1>template 中的style会影响外部样式</h1>

    <my-panel data-title="hello world" data-body="this is shadow dom"></my-panel>

    <ul is="my-ul" data-items='["aa","bb"]'></ul>
</body>
<script>
    //---------- html templates
    /**@type{HTMLTemplateElement}*/
    let ele = document.querySelector('#aTemplate');
    let templateContent = ele.content;
    // let fgmt = templateContent.cloneNode(true);
    let fgmt = document.importNode(templateContent, true);
    document.body.append(fgmt);

    //------shadow root
    class MyPanel extends HTMLElement{
        constructor() {
            super();
            const shadow = this.attachShadow({mode:'open'});
            let header = document.createElement('header');
            let title = document.createElement('div');
            title.classList.add('title');
            title.textContent = this.dataset.title || 'no header';
            header.append(title);
            let body = document.createElement('div');
            body.classList.add('body');
            body.textContent = this.dataset.body || 'no data';
            
            let style = document.createElement('style');
            style.textContent = `
                header{
                    background-color: #ddd;
                    padding: 10px;
                }
                header .title {
                    font-size: 20px;
                    font-weight: bolder;
                }
                .body{
                    border: 1px solid #ddd;
                    padding: 10px;
                }
            `;
            shadow.appendChild(style);
            shadow.appendChild(header);
            shadow.appendChild(body);
        }
    }
    customElements.define('my-panel', MyPanel);


    class MyUl extends HTMLUListElement {
        constructor() {
            super();
            this.style.width = '100px';
            this.style.height = '100px';
            this.style.backgroundColor = '#aaa';
            let items = JSON.parse(this.dataset.items);
            items.forEach(item => {
                let li = document.createElement('li');
                li.textContent = item
                this.appendChild(li);
            })
        }
    }
    customElements.define('my-ul', MyUl, {extends: 'ul'});
</script>
</html>
